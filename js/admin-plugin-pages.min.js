jQuery(document).ready(function(e){function a(e,a,n){return'<div class="epkb-top-notice-message"><div class="contents"><span class="'+n+'">'+(e?"<h4>"+e+"</h4>":"")+(a||"")+"</span></div></div>"}var n=e("#ekb-admin-page-wrap");!function(){!function(){function a(a,i){n.find(a+" > .nav_tab").on("click",function(){n.find(a+" > .nav_tab").removeClass("active"),e(this).addClass("active"),n.find(i+" > .ekb-admin-page-tab-panel").removeClass("active");var o=e(this).index()+1;n.find(i+" > .ekb-admin-page-tab-panel:nth-child( "+o+" ) ").addClass("active")})}a("#welcome_tab_nav","#welcome_panel_container"),a(".add_on_container .epkb-main-nav > .epkb-admin-pages-nav-tabs","#add_on_panels"),a(".epkb-main-nav > .epkb-admin-pages-nav-tabs","#main_panels"),a("#help_tabs_nav","#help_tab_panel")}(),function(){e.fn.epkb_displayOnClick=function(a){var n=e.extend({content:null,class:"active",fadeSpeed:200},a),i=e(this);return i.on("click",function(a){a.stopPropagation(),e(n.content).fadeToggle(n.fadeSpeed),i.toggleClass(n.class),e(n.content).toggleClass("active-content")}),e(n.content).on("click",function(e){e.stopPropagation()}),i},function(a,n){e(a).epkb_displayOnClick({content:n}),e("body").on("click",function(){e(n).fadeOut(200),e(a).removeClass("active")})}(".more_tabs",".drop_down_tabs > ul")}()}(),function(){n.find(".save_settings").on("click",function(n){n.preventDefault();var i="";e(".epkb-top-notice-message").remove();var o={action:"epkb_save_settings",_wpnonce_epkb_save_settings:e("#_wpnonce_epkb_save_settings").val(),form:e("#epkb_settings_form").serialize()};e.ajax({type:"POST",dataType:"json",data:o,url:ajaxurl,beforeSend:function(a){e("#epkb-ajax-in-progress").dialog("open")}}).done(function(n){function o(){location.reload()}(n=n||"").error||void 0==n.message?i=n.message?n.message:a("",epkb_vars.reload_try_again,"error"):(i=n.message).indexOf("reload")>=0&&(i=i.replace("reload ",""),e("#ekb_core_top_heading").replaceWith(i),i="",e("html, body").animate({scrollTop:0},"slow"),window.setTimeout(o,2e3))}).fail(function(e,n,o){i=o?" ["+o+"]":epkb_vars.unknown_error,i=a(epkb_vars.not_saved+" "+epkb_vars.msg_try_again,i,"error")}).always(function(){e("#epkb-ajax-in-progress").dialog("close"),i&&(e("#ekb_core_top_heading").replaceWith(i),e("html, body").animate({scrollTop:0},"slow"))})})}(),function(){n.find("#epkb_send_feedback").on("click",function(i){n.find(".required").remove(),e(".epkb-top-notice-message").remove(),i.preventDefault();var o="",t=n.find("#your_feedback").val().trim(),s=n.find("#your_email").val().trim(),c=n.find("#your_name").val().trim(),r=!0;if(t||(n.find("#your_feedback").after('<p class="required notification"><span class="error">* '+epkb_vars.input_required+"</span> </p>"),r=!1),s||(n.find("#your_email").after('<p class="required notification"><span class="error">* '+epkb_vars.input_required+"</span> </p>"),r=!1),c||(n.find("#your_name").after('<p class="required notification"><span class="error">* '+epkb_vars.input_required+"</span> </p>"),r=!1),0!=r){var l={action:"epkb_send_feedback",_wpnonce_epkb_send_feedback:e("#_wpnonce_epkb_send_feedback").val(),email:s,name:c,feedback:t};e.ajax({type:"POST",dataType:"json",data:l,url:ajaxurl,beforeSend:function(a){e("#epkb-ajax-in-progress-feedback").dialog("open")}}).done(function(e){o=(e=e||"").error||void 0==e.message?e.message?e.message:a("",epkb_vars.reload_try_again,"error"):e.message}).fail(function(e,n,i){o=i?" ["+i+"]":epkb_vars.unknown_error,o=a(epkb_vars.error_occurred,o,"error")}).always(function(){e("#epkb-ajax-in-progress-feedback").dialog("close"),o&&(e("#ekb_core_top_heading").replaceWith(o),e("html, body").animate({scrollTop:0},"slow"))})}}),n.find("#close_intro").on("click",function(){n.find(".welcome_header").hide();var a={action:"epkb_close_welcome_header"};e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:a})}),function(){n.find(".featured_img").on("click",function(a){a.preventDefault(),a.stopPropagation(),n.find(".image_zoom").remove();var i,o=e(this).find("img");i=o.length>1?e(o[0]).is(":visible")?e(o[0]).attr("src"):e(o[1]).is(":visible")?e(o[1]).attr("src"):e(o[2]).attr("src"):e(this).find("img").attr("src"),e(this).after('<div id="epkb_image_zoom" class="image_zoom"><img src="'+i+'" class="image_zoom"><span class="close icon_close"></span></div>'),e("html, body").bind("click.epkb",function(){e("#epkb_image_zoom").remove(),e("html, body").unbind("click.epkb")})})}(),e("#kb_name").on("keyup",function(){var a=25-e(this).val().length;e("#character_value").remove(),a<0&&e(this).after('<div id="character_value" class="input_error"><p>'+epkb_vars.reduce_name_size+"</p></div>")}),e("#epkb-welcome-page-img1-thumb").on("click",function(){e("#epkb-welcome-page-img1").show(),e("#epkb-welcome-page-img2").hide(),e("#epkb-welcome-page-img3").hide()}),e("#epkb-welcome-page-img2-thumb").on("click",function(){e("#epkb-welcome-page-img2").show(),e("#epkb-welcome-page-img1").hide(),e("#epkb-welcome-page-img3").hide()}),e("#epkb-welcome-page-img3-thumb").on("click",function(){e("#epkb-welcome-page-img3").show(),e("#epkb-welcome-page-img1").hide(),e("#epkb-welcome-page-img2").hide()})}(),function(){var a=e("#epkb-dialog-info-icon").dialog({resizable:!1,autoOpen:!1,modal:!0,buttons:{Ok:function(){e(this).dialog("close")}},close:function(){e("#epkb-dialog-info-icon-msg").html()}});n.find(".ekb-admin-page-tab-panel, .epkb-config-sidebar-options").on("click",".info-icon",function(){var n=!1,i="",o=e(this).parent().find(".label").text();o=o||"";var t=e(this).find("p").html();if(t){var s=t.split("@");t=s[0]?s[0]:"Help text is coming soon.",s[1]&&(n=!0,i='<img class="epkb-help-image" src="'+s[1]+'">')}else t="Help text is coming soon.";e("#epkb-dialog-info-icon-msg").html("<p>"+t+"</p><br/>"+i),a.dialog({title:o,width:n?1e3:400,maxHeight:n?750:300,open:function(){e("#epkb-dialog-info-icon").find(".epkb-help-image").one("load",function(){a.dialog("option",{position:{my:"center",at:"center",of:window}})}),e(".ui-widget-overlay").bind("click",function(){e("#epkb-dialog-info-icon").dialog("close")})}}).dialog("open")}),e("#epkb-ajax-in-progress").dialog({resizable:!1,height:70,width:200,modal:!1,autoOpen:!1}).hide(),e("#epkb-ajax-in-progress-feedback").dialog({resizable:!1,height:70,width:300,modal:!0,autoOpen:!1}).hide(),e(".ui-dialog-titlebar").hide()}()});