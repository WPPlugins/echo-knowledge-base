jQuery(document).ready(function(e){function a(a){e(".epkb-panel-container .epkb-tab-panel:nth-child("+(a+1)+")").addClass("active")}function i(e,a){var i=window.location.href;i=t(i,"top-category",a),window.history.pushState({tab:e},"title",i)}function t(e,a,i){var t=new RegExp("([?&])"+a+"=.*?(&|$)","i"),s=-1!==e.indexOf("?")?"&":"?";return e.match(t)?e.replace(t,"$1"+a+"="+i+"$2"):e+s+a+"="+i}var s=e("#epkb-main-page-container"),n=e("#epkb-content-container"),o=e(".epkb-nav-tabs li"),c=e(".epkb-tab-panel");e("body").on("submit","#epkb_search_form",function(a){if(a.preventDefault(),""!=e("#epkb_search_terms").val()){var i={action:"epkb-search-kb",epkb_kb_id:e("#epkb_kb_id").val(),search_words:e("#epkb_search_terms").val()},t="";e.ajax({type:"GET",dataType:"json",data:i,url:ajaxurl,beforeSend:function(a){e(".loading-spinner").css("display","block"),e("#epkb-ajax-in-progress").show()}}).done(function(a){a=a||"",e(".loading-spinner").css("display","none"),t=a.error||"success"!=a.status?epkb_vars.msg_try_again:a.search_result}).fail(function(e,a,i){t=epkb_vars.msg_try_again+". ["+(i||epkb_vars.unknown_error)+"]"}).always(function(){e("#epkb-ajax-in-progress").hide(),t&&(e("#epkb_search_results").css("display","block"),e("#epkb_search_results").html(t))})}}),e("#epkb_search_terms").keyup(function(){this.value||e("#epkb_search_results").css("display","none")}),e(window).load(function(){var a=0;n.find(o).each(function(){var i=e(this).outerHeight(!0);i>a&&(a=i)}),n.find(o).css("min-height",a)}),window.onpopstate=function(a){a.state&&-1!==a.state.tab.indexOf("epkb_tab_")?(n.find(".epkb_top_panel").removeClass("active"),e("#main-category-selection").length>0?e("#main-category-selection").val(n.find("#"+a.state.tab).val()):(n.find(".epkb_top_categories").removeClass("active"),n.find("#"+a.state.tab).addClass("active")),n.find("."+a.state.tab).addClass("active")):e("#epkb_tab_1").length>0&&!n.find("#epkb_tab_1").hasClass("active")&&(n.find(".epkb_top_panel").removeClass("active"),e("#main-category-selection").length>0?e("#main-category-selection").val(n.find("#epkb_tab_1").val()):(n.find(".epkb_top_categories").removeClass("active"),n.find("#epkb_tab_1").addClass("active")),n.find(".epkb_tab_1").addClass("active"))},n.find(o).each(function(){e(this).on("click",function(){n.find(o).removeClass("active"),e(this).addClass("active"),n.find(c).removeClass("active"),a(e(this).index()),i(e(this).attr("id"),e(this).data("cat-name"))})}),e("#main-category-selection").change(function(){n.find(c).removeClass("active"),e("#main-category-selection option:selected").each(function(){a(e(this).index()),i(e(this).attr("id"),e(this).data("cat-name"))})}),e(".epkb-section-body .epkb-category-level-2-3").each(function(){e(this).on("click",function(){e(this).next().toggleClass("active")})}),n.find(".epkb-section-body .epkb-category-level-2-3").each(function(){var a=e(this).find("i");e(this).on("click",function(){function e(e){a.hasClass(e[0])?(a.removeClass(e[0]),a.addClass(e[1])):a.hasClass(e[1])&&(a.removeClass(e[1]),a.addClass(e[0]))}var i=["ep_icon_plus_box","ep_icon_minus_box"],t=["ep_icon_right_arrow","ep_icon_down_arrow"],s=["ep_icon_arrow_carrot_right","ep_icon_arrow_carrot_down"],n=["ep_icon_arrow_carrot_right_circle","ep_icon_arrow_carrot_down_circle"],o=["ep_icon_folder_add","ep_icon_folder_open"];e(["ep_icon_plus","ep_icon_minus"]),e(i),e(t),e(s),e(n),e(o)})}),s.find(".epkb-show-all-articles").on("click",function(){e(this).toggleClass("active");var a=e(this).parent("ul").find("li");e(this).hasClass("active")?(e(this).find(".epkb-show-text").addClass("epkb-hide-elem"),e(this).find(".epkb-hide-text").removeClass("epkb-hide-elem")):(e(this).find(".epkb-show-text").removeClass("epkb-hide-elem"),e(this).find(".epkb-hide-text").addClass("epkb-hide-elem")),e(a).each(function(){e(this).hasClass("epkb-hide-elem")?(e(this).removeClass("epkb-hide-elem"),e(this).addClass("visible")):e(this).hasClass("visible")&&(e(this).removeClass("visible"),e(this).addClass("epkb-hide-elem"))})})});